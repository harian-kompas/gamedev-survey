google.load("visualization","1",{packages:["corechart"]}),google.load("maps","3",{other_params:"sensor=false"}),$(document).ready(function(){"use strict";console.info("We're currently not hiring. But, are you interested in having fun with the dark side of data visualization? Fork this project: https://github.com/harian-kompas/gamedev-survey");var e="localhost"===window.location.host?"http://localhost/gamedev/public_html":"http://id.infografik.print.kompas.com/gamedev";if(Array.prototype.contains=function(e){var t,a=this.length;for(t=0;a>t;t++)if(this[t]===e)return!0;return!1},Array.prototype.distinctSingleDimension=function(){var e,t=[],a=this.length;for(e=0;a>e;e++)t.indexOf(this[e])<0&&t.push(this[e]);return t},String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)},$("#btn-add-personnels").length&&$("#btn-add-personnels").click(function(t){t.preventDefault();var a=$("<div></div>"),i=$("<div></div>"),n=$("<div></div>"),o=$("<div></div>"),s=$("<select></select>"),r=$("<div></div>"),l=$("<select></select>"),d=$("<a></a>");a.addClass("col-xs-5"),i.addClass("col-xs-6"),n.addClass("col-xs-1"),o.addClass("form-group"),s.addClass("form-control"),s.attr("name","personnels[number][]"),r.addClass("form-group"),l.addClass("form-control"),l.attr("name","personnels[edu][]"),d.addClass("btn btn-danger"),d.text("X"),o.append(s),r.append(l),a.append(o),i.append(r),n.append(d),$("#team-members").append(a,i,n),$.getJSON(e+"/api/isi",function(e){var t,a,i=$(document.createDocumentFragment()),n=$(document.createDocumentFragment());for(t=1;30>=t;t++)a=$("<option></option>"),a.attr("value",t),a.text(t+" orang"),i.append(a);s.append(i),$.each(e.academicDegrees,function(){var e=$("<option></option>");e.attr("value",this.key),e.text("lulus "+this.value),n.append(e)}),l.append(n)}),d.one("click",function(e){e.preventDefault(),a.remove(),i.remove(),n.remove()})}),$("#btn-add-products").length){var t=1;$("#btn-add-products").click(function(e){if(e.preventDefault(),$("#products").length){var a,i,n=new Date,o=n.getFullYear(),s=o-15,r=$("<div></div>"),l=$("<div></div>"),d=$("<div></div>"),p=$("<div></div>"),u=$("<div></div>"),c=$("<div></div>"),m=$("<input></input>"),h=$("<div></div>"),f=$("<select></select>"),y=$(document.createDocumentFragment()),g=$("<div></div>"),v=$(document.createDocumentFragment()),b=$("<div></div>"),T=$("<a></a>"),x=["desktop","mobile"];for(r.addClass("row"),l.addClass("col-md-4 col-xs-6"),d.addClass("col-md-3 col-xs-6"),p.addClass("col-md-4 col-xs-11"),u.addClass("col-md-1 col-xs-1"),c.addClass("form-group"),m.addClass("form-control"),m.attr("type","text"),m.attr("placeholder","Judul karya"),m.attr("maxlength",255),m.attr("name","products[name][]"),h.addClass("form-group"),f.addClass("form-control"),f.attr("name","products[year][]"),a=s;o>=a;a++)i=$("<option></option>"),i.attr("value",a),i.text(a),y.append(i);f.append(y),g.addClass("form-group"),b.addClass("checkbox"),$.each(x,function(){var e=$("<label></label>"),a=$("<input></input>");e.addClass("checkbox-inline"),a.attr("type","checkbox"),a.attr("value",this),a.attr("name","products[platform]["+t+"][]"),e.append(a).append(document.createTextNode(this.ucfirst())),v.append(e)}),b.append(v),T.addClass("btn btn-danger"),T.text("X"),c.append(m),h.append(f),g.append(b),l.append(c),d.append(h),p.append(g),u.append(T),r.append(l,d,p,u),$("#products").append(r),T.one("click",function(e){e.preventDefault(),l.remove(),d.remove(),p.remove(),u.remove(),r.remove()}),t++}})}$("#btn-submit").length&&$("#btn-submit").click(function(e){e.preventDefault();var t=$("#txt-studio-name").val().trim(),a=$("#txt-studio-location").val().trim(),i=$("#txt-studio-products").val().trim(),n=$('input[name^="publications"]'),o=0,s=!0;if(s){if(""===t)return $("#txt-studio-name").parent().addClass("has-error"),void $("#txt-studio-name").focus();if($("#txt-studio-name").parent().removeClass("has-error"),""===a)return void $("#txt-studio-location").parent().addClass("has-error");if($("#txt-studio-location").parent().removeClass("has-error"),""===i)return void $("#txt-studio-products").parent().addClass("has-error");if($("#txt-studio-products").parent().removeClass("has-error"),$.each(n,function(){$(this).checked&&o++}),!(o>0))return void $('input[name^="publications"]').parent().parent().addClass("has-error");$('input[name^="publications"]').parent().parent().removeClass("has-error")}$("#the-survey").submit()}),$.getJSON(e+"/api?t="+Date.now(),function(e){var t,a,i,n,o;t=function(){var t,a=[["Pendidikan","Pekerja"]],i={total:0,degree:[]},n=new google.visualization.PieChart(document.getElementById("edu-degree")),o={is3D:!0,legend:{position:"bottom"},slices:{0:{offset:.2},3:{offset:.4}}};$("#edu-degree").width($("#edu-degree").width()).height(Math.floor(9/16*$("#edu-degree").width())),$.each(["SD","SMP","SMA/SMK","D-1","D-2","D-3","D-4","S-1","S-2","S-3"],function(e,t){var a={name:t,total:0};i.degree.push(a)}),$.each(e,function(){var e=this,t=e.studio.personnels.education;i.total+=parseInt(e.studio.personnels.total,10),$.each(t,function(){var e=this.degree,t=this.num;$.each(i.degree,function(){e===this.name&&(this.total+=t)})})}),$.each(i.degree,function(){a.push([this.name,this.total])}),t=google.visualization.arrayToDataTable(a),n.draw(t,o)},i=function(){var t,a=[],i=function(e,t){var a,i=$(document.createDocumentFragment()),n=t.length,o=[],s=4;for($("#studios-this-year").empty(),$("#studios-this-year").parent().find("h3").text("Studio yang Muncul pada Tahun "+e),t.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),a=0;n>a;a+=s)o.push(t.slice(a,a+s));$.each(o,function(){var e=this,t=$("<div></div>"),a=$(document.createDocumentFragment());$.each(e,function(){var e=$("<div></div>"),t=$("<table></table>"),i=$("<thead></thead>"),n=$("<tr></tr>"),o=$("<th></th>"),s=$("<tbody></tbody>"),r=$("<tr></tr>"),l=$("<td></td>"),d=$("<td></td>"),p=$("<tr></tr>"),u=$("<td></td>"),c=$("<td></td>"),m="",h=this.products;$.each(h,function(){m+=this.name+" ("+this.year+", "+this.platform+"); "}),e.addClass("col-md-3"),t.addClass("table table-stripped"),o.attr("colspan",2),o.text(this.name),n.append(o),i.append(n),l.text("Lokasi"),d.text(this.location.name),r.append(l,d),u.text("Produk"),c.text(m.trim().substring(0,m.trim().length-1)),p.append(u,c),s.append(r,p),t.append(i,s),e.append(t),a.append(e)}),t.addClass("row"),t.append(a),i.append(t)}),$("#studios-this-year").append(i)},n=function(t){var a,n,o,s,r=[],l={lat:-.789275,lng:113.921327},d=[],p={gridSize:30},u=[{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{visibility:"on"},{color:"#e3e3e3"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{color:"#cccccc"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#FFFFFF"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]}],c=[];$.each(e,function(){this.studio.yearStart<=t&&r.push({lat:this.studio.location.latitude,lng:this.studio.location.longitude,locationName:this.studio.location.name}),this.studio.yearStart===t&&c.push(this.studio)}),$("#map").empty(),n={center:l,disableDefaultUI:!0,styles:u,zoom:5},a=new google.maps.Map(document.getElementById("map"),n),$.each(r,function(){o=new google.maps.Marker({position:{lat:this.lat,lng:this.lng},map:a}),d.push(o)}),s=new MarkerClusterer(a,d,p),i(t,c)},o=function(e){var t=$(document.createDocumentFragment()),a=function(e){e.on("click",function(e){e.preventDefault();var t=$(this);$(".map-nav-links").each(function(){t.text()===$(this).text()?$(this).parent().addClass("active"):$(this).parent().removeClass("active")}),n(parseInt(t.text(),10))})};$.each(e,function(e,i){var n=$("<li></li>"),o=$("<a></a>");n.addClass(0===e?"map-nav-items active":"map-nav-items"),o.addClass("map-nav-links black").attr("href","#").text(i),n.append(o),t.append(n),a(o)}),$("#map-nav").append(t)};$.each(e,function(){a.push(this.studio.yearStart)}),t=a.sort().distinctSingleDimension(),o(t),n(t[0])},n=function(){var t,a,i,n,o,s,r=[["Tahun","Desktop","Mobile"]],l=[],d=2e3,p=new Date,u=p.getFullYear(),c=new google.visualization.ColumnChart(document.getElementById("game-publications")),m={legend:{position:"in"},isStacked:!0};for($("#game-publications").width($("#game-publications").width()).height(Math.floor(9/16*$("#game-publications").width())),$.each(e,function(){var e=this.studio.products;$.each(e,function(){l.push(this)})}),i=l.length,n=d;u>=n;n++){for(t=0,a=0,o=0;i>o;o++)n===l[o].year&&("desktop"===l[o].platform?t++:"mobile"===l[o].platform&&a++);(t>0||a>0)&&r.push([n.toString(),t,a])}s=google.visualization.arrayToDataTable(r),c.draw(s,m)},o=function(){var t,a,i,n,o,s=[["Kategori","Jumlah Studio"]],r=[{min:1,max:3},{min:4,max:7},{min:8,max:10},{min:11,max:20},{min:21,max:50},{min:51,max:9999999}],l=r.length,d=e.length,p=0,u=0,c=new google.visualization.PieChart(document.getElementById("num-studios")),m={is3D:!0,legend:{position:"right"}};for(t=0;l>t;t++){for(p=r[t].min,u=r[t].max,i=0,n=t===l-1?"> 50 pekerja":p+"-"+u+" pekerja",a=0;d>a;a++)e[a].studio.personnels.total>=p&&e[a].studio.personnels.total<=u&&i++;i>0&&s.push([n,i])}$("#num-studios").width($("#num-studios").width()).height(Math.floor(9/16*$("#num-studios").width())),o=google.visualization.arrayToDataTable(s),c.draw(o,m)},a=function(){i(),o(),t(),n()},$("#map").length&&google.setOnLoadCallback(a)})});
