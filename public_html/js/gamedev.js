google.load("visualization","1",{packages:["corechart"]}),google.load("maps","3",{other_params:"sensor=false"}),$(document).ready(function(){console.info("We're currently not hiring. But, are you interested in having fun with the dark side of data visualization? Fork this project: https://github.com/harian-kompas/gamedev-survey");var e="localhost"===window.location.host?"http://localhost/gamedev/public_html":"http://id.infografik.print.kompas.com/gamedev";if(Array.prototype.contains=function(e){var t,a=this.length;for(t=0;a>t;t++)if(this[t]===e)return!0;return!1},Array.prototype.distinctSingleDimension=function(){var e,t=[],a=this.length;for(e=0;a>e;e++)t.indexOf(this[e])<0&&t.push(this[e]);return t},String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)},$("#btn-add-personnels").length&&$("#btn-add-personnels").click(function(e){if(e.preventDefault(),$("#team-members").length){var t=$("<div></div>"),a=$("<div></div>"),n=$("<div></div>"),i=$("<div></div>"),o=$("<select></select>"),r=$("<div></div>"),s=$("<select></select>"),d=$("<a></a>");t.addClass("col-md-6"),a.addClass("col-md-5"),n.addClass("col-md-1"),i.addClass("form-group"),o.addClass("form-control"),o.attr("name","personnels[number][]"),r.addClass("form-group"),s.addClass("form-control"),s.attr("name","personnels[edu][]"),d.addClass("btn btn-danger"),d.text("X"),i.append(o),r.append(s),t.append(i),a.append(r),n.append(d),$("#team-members").append(t,a,n),$.getJSON("index.php?p=api&sp=akademik",function(e){var t,a,n=$(document.createDocumentFragment()),i=$(document.createDocumentFragment());for(t=1;30>=t;t++)a=$("<option></option>"),a.attr("value",t),a.text(t+" orang"),n.append(a);o.append(n),$.each(e,function(){var e=$("<option></option>");e.attr("value",this.key),e.text("lulus "+this.value),i.append(e)}),s.append(i)}),d.one("click",function(e){e.preventDefault(),t.remove(),a.remove(),n.remove()})}}),$("#btn-add-products").length){var t=1;$("#btn-add-products").click(function(e){if(e.preventDefault(),$("#products").length){var a,n,i=new Date,o=i.getFullYear(),r=o-15,s=$("<div></div>"),d=$("<div></div>"),l=$("<div></div>"),p=$("<div></div>"),u=$("<div></div>"),c=$("<div></div>"),m=$("<input></input>"),h=$("<div></div>"),f=$("<select></select>"),v=$(document.createDocumentFragment()),g=$("<div></div>"),y=$(document.createDocumentFragment()),b=$("<div></div>"),C=$("<a></a>"),x=["desktop","mobile"];for(s.addClass("row"),d.addClass("col-md-4"),l.addClass("col-md-3"),p.addClass("col-md-4"),u.addClass("col-md-1"),c.addClass("form-group"),m.addClass("form-control"),m.attr("type","text"),m.attr("placeholder","Judul karya"),m.attr("maxlength",255),m.attr("name","products[name][]"),h.addClass("form-group"),f.addClass("form-control"),f.attr("name","products[year][]"),a=r;o>=a;a++)n=$("<option></option>"),n.attr("value",a),n.text(a),v.append(n);f.append(v),g.addClass("form-group"),b.addClass("checkbox"),$.each(x,function(){var e=$("<label></label>"),a=$("<input></input>");e.addClass("checkbox-inline"),a.attr("type","checkbox"),a.attr("value",this),a.attr("name","products[platform]["+t+"][]"),e.append(a).append(document.createTextNode(this.ucfirst())),y.append(e)}),b.append(y),C.addClass("btn btn-danger"),C.text("X"),c.append(m),h.append(f),g.append(b),d.append(c),l.append(h),p.append(g),u.append(C),s.append(d,l,p,u),$("#products").append(s),C.one("click",function(e){e.preventDefault(),d.remove(),l.remove(),p.remove(),u.remove(),s.remove()}),t++}})}$("#btn-submit").length&&$("#btn-submit").click(function(e){e.preventDefault();var t=$("#txt-studio-name").val().trim(),a=$("#txt-studio-location").val().trim(),n=$("#txt-studio-products").val().trim(),i=$('input[name^="publications"]'),o=0,r=!0;if(r){if(""===t)return void $("#txt-studio-name").parent().addClass("has-error");if($("#txt-studio-name").parent().removeClass("has-error"),""===a)return void $("#txt-studio-location").parent().addClass("has-error");if($("#txt-studio-location").parent().removeClass("has-error"),""===n)return void $("#txt-studio-products").parent().addClass("has-error");if($("#txt-studio-products").parent().removeClass("has-error"),$.each(i,function(){$(this).checked&&o++}),!(o>0))return void $('input[name^="publications"]').parent().parent().addClass("has-error");$('input[name^="publications"]').parent().parent().removeClass("has-error")}$("#the-survey").submit()}),$.getJSON(e+"/api?t="+Date.now(),function(e){var t,a,n,i,o;t=function(){var t,a=[["Pendidikan","Pekerja"]],n={total:0,degree:[]},i=new google.visualization.PieChart(document.getElementById("edu-degree")),o={is3D:!0,legend:{position:"bottom"},slices:{0:{offset:.2},3:{offset:.4}}};$("#edu-degree").width($("#edu-degree").width()).height(Math.floor(9/16*$("#edu-degree").width())),$.each(["SD","SMP","SMA/SMK","D-1","D-2","D-3","D-4","S-1","S-2","S-3"],function(e,t){var a={name:t,total:0};n.degree.push(a)}),$.each(e,function(){var e=this,t=e.studio.personnels.education;n.total+=parseInt(e.studio.personnels.total,10),$.each(t,function(){var e=this.degree,t=this.num;$.each(n.degree,function(){e===this.name&&(this.total+=t)})})}),$.each(n.degree,function(){a.push([this.name,this.total])}),t=google.visualization.arrayToDataTable(a),i.draw(t,o)},n=function(){var t,a=[],n=function(e,t){var a,n=$(document.createDocumentFragment()),i=t.length,o=[],r=4;for($("#studios-this-year").empty(),$("#studios-this-year").parent().find("h3").text("Studio yang Muncul pada Tahun "+e),t.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),a=0;i>a;a+=r)o.push(t.slice(a,a+r));$.each(o,function(){var e=this,t=$("<div></div>"),a=$(document.createDocumentFragment());$.each(e,function(){var e=$("<div></div>"),t=$("<table></table>"),n=$("<thead></thead>"),i=$("<tr></tr>"),o=$("<th></th>"),r=$("<tbody></tbody>"),s=$("<tr></tr>"),d=$("<td></td>"),l=$("<td></td>"),p=$("<tr></tr>"),u=$("<td></td>"),c=$("<td></td>"),m="",h=this.products;$.each(h,function(){m+=this.name+" ("+this.year+", "+this.platform+"); "}),e.addClass("col-md-3"),t.addClass("table table-stripped"),o.attr("colspan",2),o.text(this.name),i.append(o),n.append(i),d.text("Lokasi"),l.text(this.location.name),s.append(d,l),u.text("Produk"),c.text(m.trim().substring(0,m.trim().length-1)),p.append(u,c),r.append(s,p),t.append(n,r),e.append(t),a.append(e)}),t.addClass("row"),t.append(a),n.append(t)}),$("#studios-this-year").append(n)},i=function(t){var a,i,o,r,s=[],d={lat:-.789275,lng:113.921327},l=[],p={gridSize:30},u=[{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{visibility:"on"},{color:"#e3e3e3"}]},{featureType:"landscape.natural",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{color:"#cccccc"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#FFFFFF"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]}],c=[];$.each(e,function(){this.studio.yearStart<=t&&s.push({lat:this.studio.location.latitude,lng:this.studio.location.longitude,locationName:this.studio.location.name}),this.studio.yearStart===t&&c.push(this.studio)}),$("#map").empty(),i={center:d,disableDefaultUI:!0,styles:u,zoom:5},a=new google.maps.Map(document.getElementById("map"),i),$.each(s,function(){o=new google.maps.Marker({position:{lat:this.lat,lng:this.lng},map:a}),l.push(o)}),r=new MarkerClusterer(a,l,p),n(t,c)},o=function(e){var t=$(document.createDocumentFragment()),a=function(e){e.on("click",function(e){e.preventDefault();var t=$(this);$(".map-nav-links").each(function(){t.text()===$(this).text()?$(this).parent().addClass("active"):$(this).parent().removeClass("active")}),i(parseInt(t.text(),10))})};$.each(e,function(e,n){var i=$("<li></li>"),o=$("<a></a>");i.addClass(0===e?"map-nav-items active":"map-nav-items"),o.addClass("map-nav-links black").attr("href","#").text(n),i.append(o),t.append(i),a(o)}),$("#map-nav").append(t)};$.each(e,function(){a.push(this.studio.yearStart)}),t=a.sort().distinctSingleDimension(),o(t),i(t[0])},i=function(){var t,a,n,i,o,r,s=[["Tahun","Desktop","Mobile"]],d=[],l=2e3,p=new Date,u=p.getFullYear(),c=new google.visualization.ColumnChart(document.getElementById("game-publications")),m={legend:{position:"in"},isStacked:!0};for($("#game-publications").width($("#game-publications").width()).height(Math.floor(9/16*$("#game-publications").width())),$.each(e,function(){var e=this.studio.products;$.each(e,function(){d.push(this)})}),n=d.length,i=l;u>=i;i++){for(t=0,a=0,o=0;n>o;o++)i===d[o].year&&("desktop"===d[o].platform?t++:"mobile"===d[o].platform&&a++);(t>0||a>0)&&s.push([i.toString(),t,a])}r=google.visualization.arrayToDataTable(s),c.draw(r,m)},o=function(){var t,a,n,i,o,r=[["Kategori","Jumlah Studio"]],s=[{min:1,max:3},{min:4,max:7},{min:8,max:10},{min:11,max:20},{min:21,max:50},{min:51,max:9999999}],d=s.length,l=e.length,p=0,u=0,c=new google.visualization.PieChart(document.getElementById("num-studios")),m={is3D:!0,legend:{position:"right"}};for(t=0;d>t;t++){for(p=s[t].min,u=s[t].max,n=0,i=t===d-1?"> 50 pekerja":p+"-"+u+" pekerja",a=0;l>a;a++)e[a].studio.personnels.total>=p&&e[a].studio.personnels.total<=u&&n++;n>0&&r.push([i,n])}$("#num-studios").width($("#num-studios").width()).height(Math.floor(9/16*$("#num-studios").width())),o=google.visualization.arrayToDataTable(r),c.draw(o,m)},a=function(){n(),o(),t(),i()},$("#map").length&&google.setOnLoadCallback(a)})});
